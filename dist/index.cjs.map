{"version":3,"sources":["../src/index.ts","../src/utils/misc.ts","../src/utils/debugger.ts","../src/hooks/observe.hook.ts","../src/hooks/post.hook.ts","../src/hooks/listen.hook.ts"],"sourcesContent":["export * from \"./utils/debugger.js\";\r\nexport * from \"./utils/misc.js\";\r\nexport * from \"./hooks/index.js\";\r\nexport * from \"./types/index.js\";\r\n","export const isEnvBrowser = (): boolean => !(window as any).invokeNative;\r\nexport const noop = () => {};\r\n","import type { DebuggerEventType } from \"../types/debugger.types.js\";\r\nimport { isEnvBrowser } from \"./misc.js\";\r\n\r\nexport class Debugger {\r\n  private events: DebuggerEventType[];\r\n  private timer: number = 1000;\r\n\r\n  constructor(events: DebuggerEventType[], timer?: number) {\r\n    this.events = events;\r\n    if (timer) {\r\n      this.timer = timer;\r\n    }\r\n    if (isEnvBrowser()) {\r\n      this.startProcessing();\r\n    }\r\n  }\r\n\r\n  private startProcessing(): void {\r\n    this.events.forEach((event) => {\r\n      setTimeout(() => {\r\n        this.handleEvent(event);\r\n      }, this.timer);\r\n    });\r\n  }\r\n\r\n  private handleEvent(event: DebuggerEventType): void {\r\n    console.log(\"Processing event:\", event);\r\n    setTimeout(() => {\r\n      window.dispatchEvent(\r\n        new MessageEvent(\"message\", {\r\n          data: { ...event },\r\n        })\r\n      );\r\n    });\r\n  }\r\n}\r\n","import { type RefObject, useEffect, useRef } from \"react\";\r\n\r\nimport { isEnvBrowser, noop } from \"../utils/misc.js\";\r\nimport type { ObservedMessageType } from \"../types/observe.hook.types.js\";\r\n\r\ntype NuiHandlerSignature<T> = (data: T) => void;\r\n\r\nclass NuiListener<T> {\r\n  private action: string;\r\n  private savedHandler: RefObject<NuiHandlerSignature<T>>;\r\n\r\n  constructor(action: string, handler: NuiHandlerSignature<T>) {\r\n    this.action = action;\r\n    this.savedHandler = useRef<NuiHandlerSignature<T>>(noop);\r\n    this.setHandler(handler);\r\n  }\r\n\r\n  setHandler(handler: NuiHandlerSignature<T>) {\r\n    this.savedHandler.current = handler;\r\n  }\r\n\r\n  observe() {\r\n    const eventListener = (event: MessageEvent<ObservedMessageType<T>>) => {\r\n      const { action: eventAction, data } = event.data;\r\n      if (eventAction === this.action && this.savedHandler.current) {\r\n        if (isEnvBrowser()) {\r\n          console.log(\"Observed event:\", event);\r\n        }\r\n        this.savedHandler.current(data);\r\n      }\r\n    };\r\n    window.addEventListener(\"message\", eventListener);\r\n\r\n    return () => window.removeEventListener(\"message\", eventListener);\r\n  }\r\n}\r\n\r\nexport const useObserve = <T = unknown>(\r\n  action: string,\r\n  handler: (data: T) => void\r\n) => {\r\n  const listener = useRef(new NuiListener<T>(action, handler));\r\n\r\n  useEffect(() => {\r\n    listener.current.setHandler(handler);\r\n  }, [handler]);\r\n\r\n  useEffect(() => {\r\n    return listener.current.observe();\r\n  }, [action]);\r\n};\r\n","import { isEnvBrowser } from \"../utils/misc.js\";\r\n\r\nexport class Post<T = unknown> {\r\n  private eventName: string;\r\n  private data?: unknown;\r\n  private mockData?: T;\r\n\r\n  private constructor(eventName: string, data?: unknown, mockData?: T) {\r\n    this.eventName = eventName;\r\n    this.data = data;\r\n    this.mockData = mockData;\r\n  }\r\n\r\n  public static async create<T>(\r\n    eventName: string,\r\n    data?: unknown,\r\n    mockData?: T\r\n  ): Promise<T> {\r\n    const instance = new Post(eventName, data, mockData);\r\n    return instance.execute();\r\n  }\r\n\r\n  private async execute(): Promise<T> {\r\n    const options = {\r\n      method: \"post\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json; charset=UTF-8\",\r\n      },\r\n      body: JSON.stringify(this.data),\r\n    };\r\n\r\n    if (isEnvBrowser() && this.mockData) {\r\n      return this.mockData;\r\n    }\r\n\r\n    const resourceName = (window as any).GetParentResourceName\r\n      ? (window as any).GetParentResourceName()\r\n      : \"nui-frame-app\";\r\n\r\n    try {\r\n      const resp = await fetch(\r\n        `https://${resourceName}/${this.eventName}`,\r\n        options\r\n      );\r\n      const respFormatted = await resp.json();\r\n      return respFormatted;\r\n    } catch (error) {\r\n      console.error(\"Error:\", error);\r\n      throw error;\r\n    }\r\n  }\r\n}\r\n","import { type RefObject, useEffect, useRef } from \"react\";\r\n\r\ntype EventHandlerSignature<T = Event> = (event: T) => void;\r\n\r\nclass Listener<T extends Event = Event> {\r\n  private event: string;\r\n  private savedHandler: RefObject<EventHandlerSignature<T>>;\r\n\r\n  constructor(event: string, handler: EventHandlerSignature<T>) {\r\n    this.event = event;\r\n    this.savedHandler = useRef<EventHandlerSignature<T>>(handler);\r\n  }\r\n\r\n  setHandler(handler: EventHandlerSignature<T>) {\r\n    this.savedHandler.current = handler;\r\n  }\r\n\r\n  listen(target: EventTarget) {\r\n    const eventListener = (event: Event) => {\r\n      this.savedHandler.current(event as T);\r\n    };\r\n    target.addEventListener(this.event, eventListener);\r\n    return () => target.removeEventListener(this.event, eventListener);\r\n  }\r\n}\r\n\r\nexport const useListen = <T extends Event = Event>(\r\n  event: string,\r\n  handler: EventHandlerSignature<T>,\r\n  target: EventTarget = window\r\n) => {\r\n  const listener = useRef(new Listener<T>(event, handler));\r\n\r\n  useEffect(() => {\r\n    listener.current.setHandler(handler);\r\n  }, [handler]);\r\n\r\n  useEffect(() => {\r\n    return listener.current.listen(target);\r\n  }, [event, target]);\r\n};\r\n"],"mappings":"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","names":["import_react"]}